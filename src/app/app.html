<!-- src/app/app.html -->
<main class="main">
  <div class="content">
    <div class="left-side">
      <h1>Welcome to Yappers!</h1>

      <!-- Login/Logout -->
      <p *ngIf="!role">Please login to continue ðŸŽ‰</p>
      <p *ngIf="role">Hello, {{ username }}! Your role: {{ role }}</p>
      <button *ngIf="!role" (click)="showLogin = true" class="btn">Login</button>
      <button *ngIf="role" (click)="logout()" class="btn logout">Logout</button>

      <!-- Login Popup -->
      <div *ngIf="showLogin" class="login-popup">
        <div class="login-box">
          <h2>Login</h2>
          <input [(ngModel)]="username" type="text" placeholder="Username">
          <input [(ngModel)]="password" type="password" placeholder="Password">
          <div class="login-buttons">
            <button (click)="login()">Submit</button>
            <button (click)="showLogin = false">Cancel</button>
          </div>
          <p class="error-message">{{ message }}</p>
        </div>
      </div>

      <!-- Role-based Group Management -->
      <div *ngIf="role" class="groups-container">
        <h3>Groups & Channels</h3>
        <button *ngIf="role==='super-admin'" (click)="addGroup()" class="btn">Add Group</button>
        <div *ngFor="let group of groups" class="group">
          <h4>{{ group.name }}</h4>
          <div *ngIf="role==='super-admin' || (role==='group-admin' && group.owner===username)">
            <button (click)="addChannel(group)" class="btn small">Add Channel</button>
            <button (click)="deleteGroup(group)" class="btn small delete">Delete Group</button>
          </div>
          <div class="channels">
            <button *ngFor="let channel of group.channels"
                    (click)="selectChannel(group.name, channel)"
                    [class.active]="selectedGroup===group.name && selectedChannel===channel">
              {{ channel }}
            </button>
          </div>
          <div *ngIf="role==='super-admin' || (role==='group-admin' && group.owner===username)">
            <button (click)="deleteUserFromGroup(group, 'user')" class="btn small delete">Remove User</button>
          </div>
        </div>
      </div>

      <!-- Chat -->
      <div *ngIf="selectedGroup && selectedChannel" class="chat-container">
        <h3>Channel: {{ selectedChannel }} (Group: {{ selectedGroup }})</h3>
        <div class="messages">
          <div *ngFor="let msg of messages">
            <strong>{{ msg.user }}:</strong> {{ msg.content }}
          </div>
        </div>
        <input [(ngModel)]="newMessage" placeholder="Type your message">
        <button (click)="sendMessage()">Send</button>
      </div>
    </div>
  </div>
</main>

<style>
/* Background & Main Layout */
.main {
  width: 100%;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: "Inter", sans-serif;
  background: linear-gradient(135deg, #f06, #7702ff);
  color: #fff;
  text-align: center;
}

/* Headers */
h1 {
  font-size: 3rem;
  margin-bottom: 1rem;
}

h3 {
  margin-top: 2rem;
}

h4 {
  margin: 1rem 0 0.5rem 0;
}

/* Paragraphs */
p {
  font-size: 1.25rem;
  margin-bottom: 1rem;
}

/* Buttons */
.btn {
  background: #fff;
  color: #7702ff;
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: 0.5rem;
  cursor: pointer;
  font-size: 1rem;
  transition: transform 0.2s;
  margin: 0.25rem;
}

.btn:hover {
  transform: scale(1.05);
}

.btn.small {
  padding: 0.3rem 0.6rem;
  font-size: 0.9rem;
}

.btn.delete {
  background: #ff4d4d;
  color: #fff;
}

/* Login popup */
.login-popup {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.5);
  display: flex; justify-content: center; align-items: center;
}

.login-box {
  background: white;
  color: black;
  padding: 30px;
  border-radius: 8px;
  text-align: center;
  width: 300px;
}

.login-box input {
  width: 100%;
  margin-bottom: 10px;
  padding: 8px;
}

.login-buttons {
  margin-top: 10px;
}

.error-message {
  color: red;
  margin-top: 10px;
}

/* Groups & Channels */
.groups-container {
  margin-top: 2rem;
}

.channels button.active {
  background: #ffef00;
  color: #7702ff;
  font-weight: bold;
}

/* Chat */
.chat-container {
  margin-top: 2rem;
}

.messages {
  background: rgba(255,255,255,0.2);
  padding: 10px;
  height: 200px;
  overflow-y: scroll;
  border-radius: 8px;
  margin-bottom: 10px;
  text-align: left;
}
</style>
